<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skedaddle Technician Portal</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        
        body { 
            font-family: 'Inter', sans-serif; 
            margin: 0; 
            overflow-x: hidden;
            min-height: 100vh;
            background-color: #f8fafc;
            color: #1e293b;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }
        @media (max-width: 768px) { .calendar-grid { grid-template-columns: repeat(3, 1fr); } }
        @media (max-width: 480px) { .calendar-grid { grid-template-columns: repeat(2, 1fr); } }

        .google-btn {
            background: #4285F4;
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s;
            width: 100%;
            justify-content: center;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }
        .google-btn:hover { background: #357abd; transform: translateY(-1px); }

        .hub-card {
            transition: all 0.2s ease-out;
        }
        .hub-card:active {
            transform: scale(0.98);
        }
        
        .animate-slide-up {
            animation: slideUp 0.3s ease-out forwards;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const CLIENT_ID = "826145031424-e5rd2jbbnreu8am7re4m6qpc6m9aqpgl.apps.googleusercontent.com"; 
        const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw-DhbESKUSJrOfYooCTZqXO5vySlaDVaoLQCHTT2AlI5zTv7i6tdzzX1f6xwzdHK4e4A/exec";
        const LOGO_URL = "https://www.skedaddlewildlife.com/wp-content/themes/salcode-bootstrap-genesis/images/logo_r.png";
        const SUPERVISOR_EMAIL = "magicbran@gmail.com";
        const MANUAL_FULL_URL = "https://drive.google.com/file/d/1iSar6lHhH5gNLbNj2RctD05ODisbSqE3/view?usp=sharing";

        const Icons = {
            LogOut: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>,
            LogIn: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 5 12 10 7"/><line x1="15" y1="12" x2="5" y2="12"/></svg>,
            UserCheck: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polyline points="16 11 18 13 22 9"/></svg>,
            Alert: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
            Calendar: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
            Loader: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={`animate-spin ${props.className}`}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>,
            Layout: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>,
            Clock: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            FileText: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14.5 2 14.5 7 20 7"/></svg>,
            ExternalLink: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>,
            ArrowLeft: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
            Hammer: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="m15 12-8.5 8.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L12 9"/><path d="M17.64 15 22 10.64"/><path d="m20.91 11.7-1.25-1.25c-.6-.6-.93-1.4-.93-2.25v-.86c0-1 .81-1.84 1.81-1.84.28 0 .56.07.82.19l.52.26c.3.15.65.15.95 0l.52-.26a1.84 1.84 0 0 1 2.56 1.68v.86c0 .85-.33 1.65-.93 2.25l-1.25 1.25c-.24.24-.24.62 0 .86l1.25 1.25c.6.6.93 1.41.93 2.25v.86c0 1-.81 1.84-1.81 1.84-.28 0-.56-.07-.82-.19l-.52-.26c-.3-.15-.65-.15-.95 0l-.52.26a1.84 1.84 0 0 1-2.56-1.68v-.86c0-.84.33-1.65.93-2.25l1.25-1.25c.24-.24.24-.62 0-.86Z"/></svg>,
            CheckCircle: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
        };

        const SPECIES_DATA = {
            'Raccoons': { 
                icon: 'ðŸ¾', 
                bio: 'Intelligent, dexterous, and strong. Maternal cycle begins late winter.', 
                signs: 'Hand-like prints, high-pitched chattering, heavy thumping at night, large tubular scat (look for undigested seeds).',
                entry: 'Roof vents, soffits, chimneys, roof-wall junctions (RSI).', 
                method: 'Check valves or physical removal of young. Ensure 16-gauge mesh is bolted, not just stapled.' 
            },
            'Squirrels': { 
                icon: 'ðŸ¥œ', 
                bio: 'Aggressive chewers. Diurnal activity (most active at dawn/dusk).', 
                signs: 'Quick scratching sounds, chewed plastic/wood, small oval scat (pointed ends), nut shells in attic.',
                entry: 'Roof corners, fascia board gaps, cedar siding, plastic vent caps.', 
                method: 'One-way exclusion doors. Seal all non-primary gaps with galvanized steel mesh first.' 
            },
            'Bats': { 
                icon: 'ðŸ¦‡', 
                bio: 'Protected species. Maternal colonies active June-August (Blackout period).', 
                signs: 'Staining at entry (rub marks), guano piles (crumbles like dry soil), high-pitched chirps.',
                entry: 'Ridge vents, brick gaps, gable vents, flashing overlaps.', 
                method: 'Install one-way netting curtains or cones. Must wait for non-birthing season to seal.' 
            },
            'Birds': { 
                icon: 'ðŸ¦', 
                bio: 'Starlings and Sparrows are most common. Nesting material is a fire hazard.', 
                signs: 'Visible straw from vents, constant chirping, mites, heavy ammonia odor from waste.',
                entry: 'Bathroom exhaust vents, dryer vents, kitchen vents.', 
                method: 'Remove nest, sanitize with antimicrobial, install heavy-duty bird-proof vent guards.' 
            },
            'Skunks': { 
                icon: 'ðŸ¦¨', 
                bio: 'Ground burrowers. Docile but defensive. Excellent diggers.', 
                signs: 'Distinct musk odor, cone-shaped holes in lawn, 4-6" burrows under structures.',
                entry: 'Under decks, sheds, concrete stairs, crawlspace vents.', 
                method: 'Trenching and Screening: Dig 1ft down, 1ft out (L-shape). Install OWD at primary exit.' 
            }
        };

        const WORK_GUIDES = {
            'rsi': {
                label: "RSI Guide",
                desc: "Roof Soffit Intersections",
                steps: [
                    "Inspect the 'V' where the roofline meets the soffit.",
                    "Ensure mesh is tucked behind the fascia board.",
                    "Secure with 1-inch zip screws and washers every 4-6 inches.",
                    "Paint mesh to match trim for aesthetics."
                ]
            },
            'plumbing': {
                label: "Plumbing Guide",
                desc: "Stacks & Pipe Vents",
                steps: [
                    "Clear any debris around the stack base.",
                    "Measure circumference for custom mesh fit.",
                    "Install a 'Skedaddle Hat' or custom screening.",
                    "Verify the rubber boot is not damaged."
                ]
            },
            'roof-vents': {
                label: "Roof Vents Guide",
                desc: "Static & Ridge Vents",
                steps: [
                    "Check for pulled nails or chewed plastic corners.",
                    "Cage vents with 1x1 galvanized steel mesh.",
                    "Ensure the cage is tall enough for the vent to breathe.",
                    "Seal base with professional grade sealant."
                ]
            },
            'bsg': {
                label: "Sealing BSG",
                desc: "Bottom Sill Gasket / Base",
                steps: [
                    "Inspect where the siding meets the foundation.",
                    "Seal gaps larger than 1/4 inch with mesh or sealant.",
                    "Ensure proper drainage (don't block weep holes entirely).",
                    "Check corner posts for hidden entry paths."
                ]
            },
            'owds': {
                label: "OWD Fabrication",
                desc: "One-Way Door Build",
                steps: [
                    "Construct 'tunnel' using galvanized mesh.",
                    "Install the 'flap' with enough tension to snap shut.",
                    "Ensure zero resistance for the animal exiting.",
                    "Label with date of installation for follow-up."
                ]
            }
        };

        const App = () => {
            const [user, setUser] = useState(() => {
                const saved = localStorage.getItem('skedaddle_user');
                return saved ? JSON.parse(saved) : null;
            });
            const [activeTab, setActiveTab] = useState('clock');
            const [selectedSpecies, setSelectedSpecies] = useState(null);
            const [selectedWork, setSelectedWork] = useState(null);
            const [status, setStatus] = useState('idle');
            const [logs, setLogs] = useState([]);
            const [isInitializing, setIsInitializing] = useState(true);
            const [isSyncing, setIsSyncing] = useState(false);
            const [rememberMe, setRememberMe] = useState(true);
            const [accessToken, setAccessToken] = useState(null);
            const [tokenClient, setTokenClient] = useState(null);

            const [showTimePicker, setShowTimePicker] = useState(false);
            const [pendingAction, setPendingAction] = useState(null);
            const [selHour, setSelHour] = useState(new Date().getHours());
            const [selMin, setSelMin] = useState(0);
            const [actionNote, setActionNote] = useState("");

            const checkUserStatus = async (userObj) => {
                if (!userObj) return;
                setIsSyncing(true);
                try {
                    const response = await fetch(`${APPS_SCRIPT_URL}?name=${encodeURIComponent(userObj.name)}`);
                    const data = await response.json();
                    if (data.status) setStatus(data.status);
                    if (data.logs) setLogs(data.logs);
                } catch (err) { console.error("Status error:", err); }
                setIsSyncing(false);
            };

            useEffect(() => {
                const script = document.createElement('script');
                script.src = "https://accounts.google.com/gsi/client";
                script.async = true;
                script.onload = () => {
                    const client = window.google.accounts.oauth2.initTokenClient({
                        client_id: CLIENT_ID,
                        scope: 'openid email profile https://www.googleapis.com/auth/gmail.send',
                        callback: async (tokenResponse) => {
                            if (tokenResponse.error) return;
                            setAccessToken(tokenResponse.access_token);
                            const userInfoRes = await fetch('https://www.googleapis.com/oauth2/v3/userinfo', {
                                headers: { 'Authorization': `Bearer ${tokenResponse.access_token}` }
                            });
                            const profile = await userInfoRes.json();
                            const newUser = { email: profile.email, name: profile.name, picture: profile.picture };
                            setUser(newUser);
                            if (rememberMe) localStorage.setItem('skedaddle_user', JSON.stringify(newUser));
                            checkUserStatus(newUser);
                        },
                    });
                    setTokenClient(client);
                    setIsInitializing(false);
                    if (user) checkUserStatus(user);
                };
                document.head.appendChild(script);
            }, []);

            const handleLogin = () => tokenClient?.requestAccessToken({ prompt: 'consent' });

            const handleLogout = () => {
                setUser(null);
                setAccessToken(null);
                localStorage.removeItem('skedaddle_user');
            };

            const sendEmailAsUser = async (action, time, note) => {
                const dateStr = new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                const subject = `${user.name} - ${action === "IN" ? "Start Time" : "End Time"} - ${dateStr}`;
                const message = `To: ${SUPERVISOR_EMAIL}\nSubject: ${subject}\n\n${action === "IN" ? "CLOCK IN" : "CLOCK OUT"}\nTime - ${time}\nNotes - ${note || "None"}\n\nAutomated via Hub`;
                const encodedEmail = btoa(unescape(encodeURIComponent(message))).replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');
                try {
                    await fetch('https://gmail.googleapis.com/gmail/v1/users/me/messages/send', {
                        method: 'POST',
                        headers: { 'Authorization': `Bearer ${accessToken}`, 'Content-Type': 'application/json' },
                        body: JSON.stringify({ raw: encodedEmail })
                    });
                } catch (err) { console.error("Email error:", err); }
            };

            const confirmClockAction = async () => {
                const decimalTime = (selHour + (selMin / 60)).toFixed(2).padStart(5, '0');
                setShowTimePicker(false);
                setIsSyncing(true);
                if (accessToken) await sendEmailAsUser(pendingAction, decimalTime, actionNote);
                try {
                    await fetch(APPS_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'text/plain' },
                        body: JSON.stringify({ email: user.email, name: user.name, type: pendingAction, decimalTime, note: actionNote })
                    });
                    setTimeout(() => { setActionNote(""); checkUserStatus(user); }, 2500);
                } catch (err) { setIsSyncing(false); }
            };

            if (isInitializing) return (
                <div className="min-h-screen flex items-center justify-center bg-white">
                    <Icons.Loader className="w-10 h-10 text-orange-500" />
                </div>
            );

            return (
                <div className="min-h-screen max-w-2xl mx-auto px-4 py-8">
                    {!user ? (
                        <div className="bg-white rounded-[2.5rem] shadow-xl p-10 text-center border border-slate-100">
                            <img src={LOGO_URL} className="h-24 mx-auto mb-8 object-contain" alt="Logo" />
                            <h1 className="text-3xl font-extrabold text-slate-800 mb-2 uppercase tracking-tight">Technician Portal</h1>
                            <p className="text-slate-400 mb-10 font-medium">Log in to track time and access technical data.</p>
                            <button onClick={handleLogin} className="google-btn mb-6 font-bold uppercase tracking-widest text-xs">Sign in with Google</button>
                            <div className="flex items-center justify-center gap-2 cursor-pointer" onClick={() => setRememberMe(!rememberMe)}>
                                <div className={`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${rememberMe ? 'bg-blue-500 border-blue-500' : 'border-slate-300'}`}>
                                    {rememberMe && <div className="w-2 h-2 bg-white rounded-full"></div>}
                                </div>
                                <span className="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Stay signed in</span>
                            </div>
                        </div>
                    ) : (
                        <div className="space-y-6">
                            {showTimePicker && (
                                <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/80 backdrop-blur-sm p-4">
                                    <div className="bg-white rounded-[2rem] p-8 w-full max-w-sm shadow-2xl">
                                        <h2 className="text-2xl font-black mb-6 text-center uppercase tracking-tight">Confirm {pendingAction}</h2>
                                        <div className="flex justify-center gap-4 mb-6">
                                            <select value={selHour} onChange={e => setSelHour(Number(e.target.value))} className="p-4 bg-slate-50 rounded-xl text-xl font-bold border-2 border-slate-100 outline-none">
                                                {[...Array(24).keys()].map(h => <option key={h} value={h}>{h.toString().padStart(2, '0')}</option>)}
                                            </select>
                                            <select value={selMin} onChange={e => setSelMin(Number(e.target.value))} className="p-4 bg-slate-50 rounded-xl text-xl font-bold border-2 border-slate-100 outline-none">
                                                {[0, 15, 30, 45].map(m => <option key={m} value={m}>{m.toString().padStart(2, '0')}</option>)}
                                            </select>
                                        </div>
                                        <textarea value={actionNote} onChange={e => setActionNote(e.target.value)} placeholder="Enter details for the sheet..." className="w-full p-4 bg-slate-50 rounded-xl mb-6 text-sm outline-none border-2 border-slate-100" rows="3" />
                                        <button onClick={confirmClockAction} className="w-full py-4 bg-orange-600 text-white font-black rounded-xl shadow-lg uppercase tracking-widest text-xs">Confirm Entry</button>
                                        <button onClick={() => setShowTimePicker(false)} className="w-full py-4 text-slate-400 font-bold text-sm uppercase tracking-widest text-[10px]">Cancel</button>
                                    </div>
                                </div>
                            )}

                            <div className="bg-white rounded-[2rem] p-6 shadow-md flex items-center justify-between border border-slate-100">
                                <div className="flex items-center gap-4">
                                    <img src={user.picture} className="w-12 h-12 rounded-xl border-2 border-slate-50" referrerPolicy="no-referrer" />
                                    <div>
                                        <p className="font-extrabold text-slate-800 leading-none uppercase tracking-tight">{user.name}</p>
                                        <p className="text-[10px] font-bold text-orange-600 uppercase mt-1">Certified Technician</p>
                                    </div>
                                </div>
                                <button onClick={handleLogout} className="p-3 text-slate-300 hover:text-red-500 transition-colors"><Icons.LogOut className="w-5 h-5"/></button>
                            </div>

                            <div className="flex bg-slate-900 rounded-full p-1.5 shadow-lg border border-slate-800 max-w-xs mx-auto">
                                <button onClick={() => { setActiveTab('clock'); setSelectedSpecies(null); setSelectedWork(null); }} className={`flex-1 py-3 rounded-full text-[10px] font-black uppercase tracking-widest transition-all ${activeTab === 'clock' ? 'bg-orange-500 text-white shadow-md' : 'text-slate-500 hover:text-white'}`}>Time Clock</button>
                                <button onClick={() => setActiveTab('hub')} className={`flex-1 py-3 rounded-full text-[10px] font-black uppercase tracking-widest transition-all ${activeTab === 'hub' ? 'bg-blue-600 text-white shadow-md' : 'text-slate-500 hover:text-white'}`}>The Hub</button>
                            </div>

                            {activeTab === 'clock' ? (
                                <>
                                    <div className="bg-white rounded-[2rem] overflow-hidden shadow-xl border border-slate-100">
                                        <div className="p-8 bg-slate-900 text-white flex justify-between items-center">
                                            <div className="flex items-center gap-4">
                                                <div className={`p-3 bg-slate-800 rounded-xl`}><Icons.UserCheck className="w-6 h-6 text-orange-500" /></div>
                                                <div><p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1">Status</p><p className="text-xl font-black">{status === 'clocked_in' ? 'SHIFT ACTIVE' : 'OFF DUTY'}</p></div>
                                            </div>
                                            <div className={`px-4 py-1.5 rounded-full text-[10px] font-black tracking-widest ${status === 'clocked_in' ? 'bg-green-500/10 text-green-500' : 'bg-slate-800 text-slate-500'}`}>{status === 'clocked_in' ? 'ONLINE' : 'OFFLINE'}</div>
                                        </div>
                                        <div className="p-8">
                                            {isSyncing && <div className="flex items-center justify-center gap-2 text-orange-500 text-[10px] font-black uppercase tracking-widest mb-6"><Icons.Loader className="w-4 h-4"/>Syncing Sheet...</div>}
                                            <div className="grid grid-cols-2 gap-4">
                                                <button disabled={status !== 'idle' || isSyncing} onClick={() => { setPendingAction('IN'); setShowTimePicker(true); }} className="p-6 rounded-2xl border-2 border-slate-50 bg-slate-50 hover:bg-green-50 hover:border-green-200 transition-all group disabled:opacity-30">
                                                    <Icons.LogIn className="w-8 h-8 text-green-600 mb-2 mx-auto" />
                                                    <span className="block font-black text-[10px] uppercase text-slate-600 group-hover:text-green-700 tracking-widest">Clock In</span>
                                                </button>
                                                <button disabled={status !== 'clocked_in' || isSyncing} onClick={() => { setPendingAction('OUT'); setShowTimePicker(true); }} className="p-6 rounded-2xl border-2 border-slate-50 bg-slate-50 hover:bg-red-50 hover:border-red-200 transition-all group disabled:opacity-30">
                                                    <Icons.LogOut className="w-8 h-8 text-red-600 mb-2 mx-auto" />
                                                    <span className="block font-black text-[10px] uppercase text-slate-600 group-hover:text-red-700 tracking-widest">Clock Out</span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-[2rem] shadow-md overflow-hidden border border-slate-100">
                                        <div className="p-6 border-b border-slate-50 flex items-center gap-3 font-black text-xs uppercase tracking-widest text-slate-500"><Icons.Calendar className="w-4 h-4 text-orange-500"/> 14-Day Cycle</div>
                                        <div className="p-4 calendar-grid">
                                            {logs.map((day, idx) => (
                                                <div key={idx} className={`p-3 rounded-2xl border flex flex-col items-center transition-all ${day.start || day.end ? 'bg-orange-50/50 border-orange-100' : 'bg-slate-50 border-slate-50 opacity-40'}`}>
                                                    <span className="text-[9px] font-bold text-slate-400 uppercase">{day.weekday}</span>
                                                    <span className="text-xs font-black text-slate-700">{day.date}</span>
                                                    <span className="text-[10px] font-extrabold mt-1 text-orange-600">{day.total}h</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </>
                            ) : (
                                <div className="space-y-6 animate-slide-up">
                                    {/* Work Guide Detail View */}
                                    {selectedWork ? (
                                        <div className="bg-white rounded-[2.5rem] p-8 shadow-xl border-4 border-blue-100">
                                            <button onClick={() => setSelectedWork(null)} className="flex items-center gap-2 text-slate-400 hover:text-slate-800 transition-colors font-black uppercase text-[10px] tracking-widest mb-6">
                                                <Icons.ArrowLeft className="w-3 h-3" /> Back to Hub
                                            </button>
                                            <div className="flex items-center gap-4 mb-8">
                                                <div className="p-4 bg-blue-600 text-white rounded-3xl"><Icons.Hammer className="w-8 h-8"/></div>
                                                <div>
                                                    <h3 className="text-2xl font-black text-slate-800 uppercase tracking-tight">{WORK_GUIDES[selectedWork].label}</h3>
                                                    <p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">{WORK_GUIDES[selectedWork].desc}</p>
                                                </div>
                                            </div>
                                            <div className="space-y-4">
                                                <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest px-1">Field Execution Steps</p>
                                                {WORK_GUIDES[selectedWork].steps.map((step, i) => (
                                                    <div key={i} className="flex gap-4 items-start p-4 bg-slate-50 rounded-2xl border border-slate-100">
                                                        <div className="w-6 h-6 rounded-full bg-blue-600 text-white flex items-center justify-center text-[10px] font-black shrink-0">{i+1}</div>
                                                        <p className="text-sm text-slate-700 font-semibold leading-snug">{step}</p>
                                                    </div>
                                                ))}
                                            </div>
                                            <div className="mt-8 pt-8 border-t border-slate-100 text-center">
                                                <p className="text-[10px] text-slate-400 font-medium mb-4 italic">Need more details? Check the full PDF manual below.</p>
                                            </div>
                                        </div>
                                    ) : (
                                        <>
                                            {/* Work Type Reference Grid */}
                                            <div className="bg-white rounded-[2.5rem] p-8 shadow-md border border-slate-100">
                                                <div className="flex items-center gap-3 mb-6">
                                                    <div className="p-3 bg-green-50 text-green-600 rounded-2xl"><Icons.Hammer className="w-5 h-5"/></div>
                                                    <h3 className="font-black uppercase text-xs tracking-widest text-slate-800">Procedures by Work Type</h3>
                                                </div>
                                                <div className="grid grid-cols-1 gap-3">
                                                    {Object.keys(WORK_GUIDES).map(key => (
                                                        <button 
                                                            key={key} 
                                                            onClick={() => setSelectedWork(key)}
                                                            className="flex items-center justify-between p-4 bg-slate-50 rounded-2xl border border-slate-100 hover:border-green-300 transition-all group"
                                                        >
                                                            <div className="text-left">
                                                                <p className="font-black text-xs text-slate-800 uppercase tracking-tight">{WORK_GUIDES[key].label}</p>
                                                                <p className="text-[9px] font-bold text-slate-400 uppercase tracking-widest mt-0.5">{WORK_GUIDES[key].desc}</p>
                                                            </div>
                                                            <div className="p-2 bg-white rounded-xl shadow-sm text-slate-300 group-hover:text-green-600">
                                                                <Icons.FileText className="w-4 h-4"/>
                                                            </div>
                                                        </button>
                                                    ))}
                                                </div>
                                            </div>

                                            {/* Species Reference */}
                                            <div className="bg-white rounded-[2.5rem] p-8 shadow-md border border-slate-100">
                                                <div className="flex items-center gap-3 mb-6">
                                                    <div className="p-3 bg-blue-50 text-blue-600 rounded-2xl"><Icons.Layout className="w-5 h-5"/></div>
                                                    <h3 className="font-black uppercase text-xs tracking-widest text-slate-800">Diagnostic Species Guide</h3>
                                                </div>
                                                <div className="grid grid-cols-2 sm:grid-cols-3 gap-3 mb-6">
                                                    {Object.keys(SPECIES_DATA).map(s => (
                                                        <button key={s} onClick={() => setSelectedSpecies(s === selectedSpecies ? null : s)} className={`p-4 rounded-2xl transition-all text-left border-2 ${selectedSpecies === s ? 'bg-blue-600 border-blue-600 text-white shadow-lg' : 'bg-slate-50 border-slate-100'}`}>
                                                            <span className="text-xl block mb-1">{SPECIES_DATA[s].icon}</span>
                                                            <span className="font-black text-[10px] uppercase tracking-tighter leading-tight">{s}</span>
                                                        </button>
                                                    ))}
                                                </div>
                                                {selectedSpecies && (
                                                    <div className="space-y-4 animate-slide-up">
                                                        <div className="p-4 bg-blue-50 rounded-2xl border border-blue-100">
                                                            <p className="text-[9px] font-black text-blue-600 uppercase tracking-widest mb-1">Diagnostic Signs (Noise/Scat/Prints)</p>
                                                            <p className="text-xs text-slate-700 font-medium leading-relaxed">{SPECIES_DATA[selectedSpecies].signs}</p>
                                                        </div>
                                                        <div className="p-4 bg-slate-900 rounded-2xl text-white">
                                                            <p className="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">Skedaddle Execution Method</p>
                                                            <p className="text-xs font-medium leading-relaxed italic">"{SPECIES_DATA[selectedSpecies].method}"</p>
                                                        </div>
                                                    </div>
                                                )}
                                            </div>

                                            {/* Full Manual Link (Fall-back) */}
                                            <a href={MANUAL_FULL_URL} target="_blank" className="bg-white rounded-[2rem] p-6 shadow-md border border-slate-100 flex items-center justify-between group hub-card">
                                                <div className="flex items-center gap-4">
                                                    <div className="p-4 bg-slate-100 text-slate-600 rounded-2xl group-hover:bg-orange-500 group-hover:text-white transition-colors"><Icons.FileText className="w-6 h-6"/></div>
                                                    <div><h3 className="font-black text-slate-800 text-sm">Full Technical Manual</h3><p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Manual Lookup & Search</p></div>
                                                </div>
                                                <div className="p-3 text-slate-300 group-hover:text-orange-600 transition-colors"><Icons.ExternalLink className="w-5 h-5"/></div>
                                            </a>
                                        </>
                                    )}
                                </div>
                            )}
                            
                            <div className="text-center pt-8 opacity-20">
                                <p className="font-black uppercase tracking-[0.5em] text-[8px] text-slate-800">Skedaddle Wildlife Control</p>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
